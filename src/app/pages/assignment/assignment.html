<div class="h-screen flex flex-col bg-dashboard-grad text-white overflow-hidden">
    <app-navbar />

    <div class="flex-1 grid grid-cols-1 lg:grid-cols-4 gap-6 px-8 pb-6 mt-[130px] h-full overflow-hidden">

        <div class="lg:col-span-3 flex flex-col gap-6 h-full overflow-hidden">

            <section class="bg-bg1/15 rounded-3xl p-4 shrink-0 border border-white/5">
                <div class="flex gap-3 overflow-x-auto pb-2 custom-scrollbar no-scrollbar">
                    @for (cat of categories; track cat) {
                    <button (click)="setCategory(cat)" 
                        [class.bg-primary]="selectedCategory === cat"
                        [class.text-black]="selectedCategory === cat" 
                        [class.bg-white/5]="selectedCategory !== cat"
                        [class.text-gray-400]="selectedCategory !== cat"
                        class="px-4 py-1 text-sm font-medium rounded-full transition-all cursor-pointer">
                        {{ cat }}
                    </button>
                    }
                </div>

                <div class="flex flex-wrap items-center justify-between gap-4 mt-4 border-t border-white/10 pt-4">
                    <div class="flex items-center gap-3">
                        <div class="relative">
                            <input type="text" placeholder="Search questions..."
                                class="bg-white/5 border border-white/10 rounded-lg py-1.5 pl-9 pr-4 text-xs text-gray-200 focus:outline-none focus:border-primary/50 w-64">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 absolute left-3 top-2 text-gray-500"
                                fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                        <select class="bg-white/5 border border-white/10 rounded-lg py-1.5 px-3 text-xs text-gray-400 focus:outline-none cursor-pointer">
                            <option>Difficulty</option>
                            <option>Easy</option>
                            <option>Medium</option>
                            <option>Hard</option>
                        </select>
                    </div>

                    <div class="text-xs text-gray-400">
                        Solved: <span class="text-primary font-bold">{{ stats.totalSolved }}</span> / {{ stats.totalQuestions }}
                    </div>
                </div>
            </section>

            <section class="bg-bg1/15 rounded-3xl p-6 flex flex-col flex-1 overflow-hidden border border-white/5">
                <div class="grid grid-cols-12 px-4 mb-4 text-[10px] uppercase tracking-widest text-gray-500 font-bold">
                    <div class="col-span-1">Status</div>
                    <div class="col-span-7 ml-1">Title</div>
                    <div class="col-span-2 text-center">Acceptance</div>
                    <div class="col-span-2 text-right">Difficulty</div>
                </div>

                <div class="space-y-3 overflow-y-auto pr-2 custom-scrollbar flex-1">
                    @for (q of filteredQuestions; track q.id) {
                    <div class="grid grid-cols-12 items-center bg-primary/5 hover:bg-bg3 border border-white/5 rounded-2xl p-4 transition-all cursor-pointer group shadow-[0_5px_3px_rgba(0,0,0,0.5)]">
                        <div class="col-span-1 flex justify-start">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-opacity duration-300"
                                [class]="getStatusColor(q.status)" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd" />
                            </svg>
                        </div>

                        <div class="col-span-7">
                            <h3 class="text-md font-medium text-gray-200 group-hover:text-white transition-colors truncate">
                                {{ q.id }}. {{ q.text }}
                            </h3>
                        </div>

                        <div class="col-span-2 text-center text-xs text-gray-400 font-medium">
                            {{ q.acceptance }}
                        </div>

                        <div class="col-span-2 text-right">
                            <span class="text-[10px] px-3 py-1 rounded-full font-bold uppercase tracking-wider"
                                [class.text-green-400]="q.difficulty === 'Easy'"
                                [class.bg-green-400/10]="q.difficulty === 'Easy'"
                                [class.text-yellow-500]="q.difficulty === 'Medium'"
                                [class.bg-yellow-500/10]="q.difficulty === 'Medium'"
                                [class.text-red-400]="q.difficulty === 'Hard'"
                                [class.bg-red-400/10]="q.difficulty === 'Hard'">
                                {{ q.difficulty }}
                            </span>
                        </div>
                    </div>
                    } @empty {
                    <div class="text-center py-10 text-gray-500 text-sm italic">No questions found for this category.</div>
                    }
                </div>
            </section>
        </div>

        <div class="hidden lg:flex flex-col gap-6 h-full overflow-hidden">

            <section class="bg-bg1/15 rounded-3xl p-6 flex flex-col items-center border border-white/5 shadow-lg">
                <h2 class="text-sm font-bold text-gray-400 uppercase tracking-widest mb-6 self-start">Solved Statistics</h2>

                <div class="relative w-36 h-36 flex items-center justify-center mb-6">
                    <svg class="absolute w-full h-full -rotate-90" viewBox="0 0 192 192">
                        <circle cx="96" cy="96" r="80" stroke="#ebd5ab1a" stroke-width="4" fill="none" />
                        <circle cx="96" cy="96" r="80" stroke="#facc15" stroke-width="12" fill="none"
                            stroke-dasharray="502"
                            [style.stroke-dashoffset]="502 - (502 * (stats.totalSolved / stats.totalQuestions))"
                            stroke-linecap="round" />
                    </svg>
                    <div class="flex flex-col items-center">
                        <span class="text-2xl font-bold text-primary">{{ stats.totalSolved }}</span>
                        <span class="text-[10px] text-gray-500 uppercase tracking-tighter">Solved</span>
                    </div>
                </div>

                <div class="w-full space-y-4">
                    <div class="space-y-1.5">
                        <div class="flex justify-between text-[11px] font-medium">
                            <span class="text-green-400">Easy</span>
                            <span class="text-gray-300">{{ stats.easy.solved }} / {{ stats.easy.total }}</span>
                        </div>
                        <div class="w-full bg-white/5 h-1.5 rounded-full overflow-hidden">
                            <div class="bg-green-400 h-full rounded-full transition-all duration-700"
                                [style.width]="getProgressWidth(stats.easy.solved, stats.easy.total)"></div>
                        </div>
                    </div>

                    <div class="space-y-1.5">
                        <div class="flex justify-between text-[11px] font-medium">
                            <span class="text-yellow-500">Medium</span>
                            <span class="text-gray-300">{{ stats.medium.solved }} / {{ stats.medium.total }}</span>
                        </div>
                        <div class="w-full bg-white/5 h-1.5 rounded-full overflow-hidden">
                            <div class="bg-yellow-500 h-full rounded-full transition-all duration-700"
                                [style.width]="getProgressWidth(stats.medium.solved, stats.medium.total)"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>